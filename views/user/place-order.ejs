<%- include('includes/header') %>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <!-- wallet  -->
    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Check Out</h4>
                        <div class="breadcrumb__links">
                            <a href="./index.html">Home</a>
                            <a href="./shop.html">Shop</a>
                            <span>Check Out</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <section class="checkout spad">
      <div class="container">
          <div class="checkout__form">
              <form action="/check-out" method="post" id="place-order-form">
                  <div class="row">
                      <div class="col-lg-8 col-md-6">
                          <h6 class="coupon__code"><span class="icon_tag_alt"></span> Have a coupon? <a href="/cart">Click
                          here</a> to enter your code</h6>
                          <div class="div">
                          <h6 class="checkout__title">Billing Details</h6>
                          <a href="/select-address" style="display: inline-block;" class="btn btn-dark ms-5">CHANGE ADDRESS</a></div>

                                <!-- style for button -->
                                <style>
                                  .div {
                                  display: flex;
                                  justify-content: center;
                                  position: relative;
                                 
                                }
                               
                                .btn {
                                  position: absolute;
                                  right: 0;
                                }
                                                                </style>

                          <div class="row">
                              <div class="col-lg-6">
                                  <div class="checkout__input">
                                      <p>Fist Name<span>*</span></p>
                                      <input type="text" style="color: rgb(0, 0, 0);" name="firstName" value="<%=defaultAddress[0].userAddress.firstName%>">
                                  </div>
                              </div>
                              <div class="col-lg-6">
                                  <div class="checkout__input">
                                      <p>Last Name<span>*</span></p>
                                      <input type="text" style="color: rgb(0, 0, 0);" name="lastName" value="<%=defaultAddress[0].userAddress.lastName%>">
                                  </div>
                              </div>
                          </div>
                          <div class="checkout__input">
                              <p>Country<span>*</span></p>
                              <input type="text" style="color: rgb(0, 0, 0);" name="country" value="<%=defaultAddress[0].userAddress.country%>">
                          </div>
                          <div class="checkout__input">
                              <p>Address<span>*</span></p>
                              <input type="text" style="color: rgb(0, 0, 0);" name="address" value="<%=defaultAddress[0].userAddress.address%>">
                              
                          </div>
                          <div class="checkout__input">
                              <p>Town/City<span>*</span></p>
                              <input type="text" style="color: rgb(0, 0, 0);" name="town" value="<%=defaultAddress[0].userAddress.town%>">
                          </div>
                          <div class="checkout__input">
                              <p>State<span>*</span></p>
                              <input type="text" style="color: rgb(0, 0, 0);" name="state" value="<%=defaultAddress[0].userAddress.state%>">
                          </div>
                          <div class="checkout__input">
                              <p>Postcode / ZIP<span>*</span></p>
                              <input type="text"style="color: rgb(0, 0, 0);" name="pinCode" value="<%=defaultAddress[0].userAddress.pinCode%>">
                          </div>
                          <div class="row">
                              <div class="col-lg-6">
                                  <div class="checkout__input">
                                      <p>Phone<span>*</span></p>
                                      <input type="text" style="color: rgb(0, 0, 0);" name="mobile" value="<%=defaultAddress[0].userAddress.mobile%>">
                                  </div>
                              </div>
                              <div class="col-lg-6">
                                  <div class="checkout__input">
                                      <p>Email<span>*</span></p>
                                      <input type="text" style="color: rgb(0, 0, 0);" name="email" value="<%=defaultAddress[0].userAddress.email%>">
                                  </div>
                                  <input type="hidden" style="color: rgb(0, 0, 0);" name="idvalue" value="<%=defaultAddress[0].userAddress._id%>" >
                              </div>
                          </div>

                          <!-- style for input  -->
                          <style>
                            .address{
                              color: rgb(255, 0, 0);
                            }
                            .error {
                                color: red;
                            }
                          </style>

                          <div class="checkout__input__checkbox">

                          </div>
                          
                          <div class="checkout__input">
                              <p>Order notes<span>*</span></p>
                              <input type="text"
                              placeholder="Notes about your order, e.g. special notes for delivery.">
                          </div>
                      </div>
                      <div class="col-lg-4 col-md-6">
                          <div class="checkout__order">
                              <h4 class="order__title">Your order</h4>
                              <div class="checkout__order__products">Product <span>Total</span></div>
                              <ul class="checkout__total__products">
                                <% for(var i = 0 ; i < cart.length; i++){%>
                                  <li><%i+1%><%=cart[i].products.productName%> <span ><%=cart[i].quantity%></span>
                                 <%}%>
                              </ul>
                              <ul class="checkout__total__all">
                                <% if(totalPriceStatus) {%>
                                  <li>Total <span><i style="color: rgb(59, 50, 50);" class="fa-sharp fa-solid fa-indian-rupee-sign"></i><%=totalprize%></span></li>
                                <%}else{%>
                                  <li>Total <i class="fa-sharp fa-solid fa-indian-rupee-sign " ></i><span id="totalprice">0</span></li>
                                <%}%>
                              </ul>
                              <div class="checkout__input__checkbox">
                                <label for="payment">
                                    COD
                                    <input type="radio" value="cod" required name="payment"  id="payment">
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                            <div class="checkout__input__checkbox">
                              <label for="razorpay">
                                  RAZORPAY
                                  <input type="radio" value="razorpay" required name="payment" id="razorpay">
                                  <span class="checkmark"></span>
                              </label>
                          </div>
                            <div class="checkout__input__checkbox">
                                <label for="paypal">
                                    PAYPAL
                                    <input type="radio" value="paypal" required name="payment" id="paypal">
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                            <%if(wallets < totalprize){%>
                              <div class="checkout__input__checkbox">
                                <label for="wallet" onclick="wallet()">
                                    WALLET
                                    <input type="radio" disabled value="wallet" required style="opacity: .5;" name="payment" id="wallet" >
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                              <%}else{%>
                            <div class="checkout__input__checkbox">
                              <label for="wallet">
                                  WALLET
                                  <input type="radio" value="wallet" required name="payment" id="wallet">
                                  <span class="checkmark"></span>
                              </label>
                          </div>
                          <%}%>
    
                          <script>
                           function wallet(){
                            
                              Swal.fire('wallets donot have enough money')
                           }
                          </script>
                            <button type="submit" class="site-btn" >PLACE ORDER</button>
                            <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
                            <script>
                               $('#check-out-form').submit((e)=>{
                                e.preventDefault()
                                $.ajax
                                ({
                                    url : '/check-out?=id',
                                    method : 'post',
                                    data : $('#check-out-form').serialize(),
                                    success : (responce)=>{
                                      if(responce)
                                        Swal.fire({
                                    position: 'center',
                                    icon: 'success',
                                    title: 'Your work has been saved',
                                    showConfirmButton: false,
                                    timer: 1500
                                    })
    
                                    }
                                })
                                    
                                    
                               })
                            </script>
                        </div>
                      </div>
                  </div>
              </form>
          </div>
      </div>
    </section>

<%- include('includes/footer') %>



