 <%- include('includes/header') %>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <!-- wallet  -->
    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Check Out</h4>
                        <div class="breadcrumb__links">
                            <a href="./index.html">Home</a>
                            <a href="./shop.html">Shop</a>
                            <span>Check Out</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

<section class="checkout spad" id="oldAddress">
    <div class="container">
        <div class="checkout__form ">
            <!-- .............................................................................................. -->
            <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Add new address</button>
           
            
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">New message</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <form id="#address-form" action="/add-address" method="post">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Fist Name<span>*</span></p>
                                    <input type="text" name="firstName">
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Last Name<span>*</span></p>
                                    <input type="text" name="lastName">
                                </div>
                            </div>
                        </div>
                        <div class="checkout__input">
                            <p>Country<span>*</span></p>
                            <input type="text" name="country">
                        </div>
                        <div class="checkout__input">
                            <p>Address<span>*</span></p>
                            <textarea type="text" placeholder="Street Address" name="address" class="checkout__input__add" style="    height: 160px;
                            width: 40%;"></textarea>
                            
                        </div>
                        <div class="checkout__input">
                            <p>Town/City<span>*</span></p>
                            <input type="text" name="town">
                        </div>
                        <div class="checkout__input">
                            <p>State<span>*</span></p>
                            <input type="text" name="state">
                        </div>
                        <div class="checkout__input">
                            <p>Postcode / ZIP<span>*</span></p>
                            <input type="text" name="pinCode">
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Phone<span>*</span></p>
                                    <input type="text" name="mobile">
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Email<span>*</span></p>
                                    <input type="text" name="email">
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="submit"  class="btn btn-primary" onclick="address()">Send message</button>
                          </div>
                    </form>
                  </div>
                  
                </div>
              </div>
            </div>


            <script>
                
         
            </script>
            <!-- ............................................................................................... -->
            <form action="" id="check-out-form">
                <div class="row">
                    <div class="col-lg-8 col-md-6">
                        <h6 class="coupon__code"><span class="icon_tag_alt"></span> Have a coupon? <a href="#">Click
                        here</a> to enter your code</h6>
                        <h6 class="checkout__title">Billing Details</h6>
                        <div class="row" >
                           <div class="row">
                            <%if(address){%>
                                <%}else{%>
                            <%alladdress.userAddress.forEach(function(user){%>
                                <div class="col-lg-6">
                            <div class="checkout__input address" >
                                
                                <input type="checkbox" name="cod" class="checkoption" style="width: 15px;height: 15px;" value="<%=user._id%>" onclick=";" >
                                <script type="text/javascript">
                                    $(document).ready(function(){
                                 
                                       $('.checkoption').click(function() {
                                          $('.checkoption').not(this).prop('checked', false);
                                       });
                                 
                                    });
                                    </script>
                                <h5>ADDRESS</h5>
                              
                                <hr>
                                 <p><input type="" disabled value="<%=user.firstName%><%=user.lastName%>"  style="border:0;width: 200%;"> 
                                 <p> <input type=""disabled value=" <%=user.country%> " style="border: 0;width: 200%;"> </p>
                                 <p><input type=""disabled value="  <%=user.address%>"  style="border: 0;width: 200%;"> </p> 
                                 <p> <input type=""disabled value="   <%=user.town%> "  style="border: 0;width: 200%;"></p>
                                 <p> <input type=""disabled value="   <%=user.pincode%> "  style="border: 0;width: 200%;"></p>
                                 <p>  <input type=""disabled value="<%=user.mobile%> "  style="border: 0;width: 200%;"></p>
                                 <p><input type=""disabled value=" <%=user.email%> "  style="border: 0;width: 200%;"> </p>
                                 </div>
                                </div>
                                <%})%>
                    <%}%>
                           </div>
                           </div>
                                <!-- ........................................................................................ -->
                            
                            
                        <div class="checkout__input__checkbox">
                           

                            <label for="acc">
                                Create an account?
                                <input type="checkbox" id="acc">
                                <span class="checkmark"></span>
                            </label>
                            <p>Create an account by entering the information below. If you are a returning customer
                            please login at the top of the page</p>
                        </div>
                        <div class="checkout__input">
                            <p>Account Password<span>*</span></p>
                            <input type="text">
                        </div>
                        <div class="checkout__input__checkbox">
                            <label for="diff-acc">
                                Note about your order, e.g, special noe for delivery
                                <input type="checkbox" id="diff-acc">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="checkout__input">
                            <p>Order notes<span>*</span></p>
                            <input type="text"
                            placeholder="Notes about your order, e.g. special notes for delivery.">
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="checkout__order">
                            <h4 class="order__title">Your order</h4>
                            <div class="checkout__order__products">Product <span >quantity</span></div>
                            <ul class="checkout__total__products">
                          
                                <li><%=order.productName%><span id="quantity" ><%=quantity%></span></li>
                                <li><i class="fa-sharp fa-solid fa-indian-rupee-sign" id="price"><%=order.price%></i></li>
                                <input type="hidden" name="quantity" id="itemQuantity">
                            
                            </ul>
                            <ul class="checkout__total__all">
                                
                                    <li >Total <span><i style="color: rgb(59, 50, 50);"  class="fa-sharp fa-solid fa-indian-rupee-sign"><span id="total" style="color: #e53637;"></span></i></span> </li>
                                   <input type="hidden" name="total" id="totalValue">
                                <script>

                                </script>
                            </ul>
                            
                            <div class="checkout__input__checkbox">
                                <label for="payment">
                                    COD
                                    <input type="radio" value="cod" name="payment" id="payment">
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                            <div class="checkout__input__checkbox">
                                <label for="paypal">
                                    PAYPAL
                                    <input type="radio" value="paypal" name="payment" id="paypal">
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                            <button type="submit" class="site-btn" >PLACE ORDER</button>

                            <script>
                                    var price = document.getElementById('price').innerHTML
                                    var quantity = document.getElementById('quantity').innerHTML
                                    // document.getElementById('total').innerHTML = parseInt(price) * parseInt(quantity)
                                    document.getElementById('totalValue').value =  document.getElementById('total').innerHTML
                                    document.getElementById('itemQuantity').value = quantity
                                    
                                 
                               $('#check-out-form').submit((e)=>{
                                e.preventDefault()
                                $.ajax
                                ({
                                    url : '/buyNow?id=<%=order._id%>',
                                    method : 'post',
                                    data : $('#check-out-form').serialize(),
                                    success : (response)=>{
                                      if(response.status){
                                        Swal.fire(
                                                'order placed!',
                                                'success'
                                                )
                                      }
                                    }
                                })
                            })
                            </script>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>


<%- include('includes/footer') %>